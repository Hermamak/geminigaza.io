<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Donate to Children in Gaza</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .form-input {
            @apply w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors;
        }
        .btn {
            @apply w-full px-6 py-3 rounded-lg text-white font-semibold transition-transform transform hover:scale-105;
        }
        .btn-primary {
            @apply bg-blue-600 hover:bg-blue-700;
        }
        .donation-amount-btn {
            @apply w-full py-3 px-2 border border-gray-300 rounded-lg text-center font-semibold text-gray-700 bg-white cursor-pointer transition-colors hover:bg-gray-100;
        }
        .donation-amount-btn.selected {
            @apply bg-blue-600 text-white border-blue-600;
        }
        .card-input-wrapper {
            position: relative;
        }
        .card-icon {
            position: absolute;
            right: 1rem;
            top: 50%;
            transform: translateY(-50%);
            width: 24px;
            height: 24px;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">

    <!-- Main container for all views -->
    <div class="w-full max-w-4xl mx-auto">
        <!-- Donation Form View -->
        <div id="donation-form-container" class="w-full max-w-lg mx-auto bg-white rounded-2xl shadow-xl p-8 transition-all duration-500">
            <div class="text-center mb-8">
                <h1 class="text-3xl font-bold text-gray-800">Support Children in Gaza</h1>
                <p class="text-gray-600 mt-2">Your kindness can bring hope and relief to those in need. This is a DEMO page for a school project.</p>
            </div>

            <form id="donation-form" onsubmit="handleDonation(event)">
                <!-- Donation Amount Section -->
                <div class="mb-6">
                    <h2 class="text-lg font-semibold text-gray-700 mb-3">Choose Donation Amount</h2>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                        <button type="button" class="donation-amount-btn" data-amount="25">$25</button>
                        <button type="button" class="donation-amount-btn selected" data-amount="50">$50</button>
                        <button type="button" class="donation-amount-btn" data-amount="100">$100</button>
                        <button type="button" class="donation-amount-btn" data-amount="250">$250</button>
                    </div>
                    <div class="mt-4 relative">
                        <span class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 text-lg">$</span>
                        <input type="number" id="custom-amount" class="form-input pl-8" placeholder="Or enter a custom amount">
                    </div>
                </div>

                <!-- Donor Details Section -->
                <div class="mb-6">
                    <h2 class="text-lg font-semibold text-gray-700 mb-3">Your Details</h2>
                    <div class="space-y-4">
                        <input type="text" id="donor-name" class="form-input" placeholder="Full Name" required>
                        <input type="email" id="donor-email" class="form-input" placeholder="Email Address" required>
                    </div>
                </div>

                <!-- Payment Information Section -->
                <div>
                    <h2 class="text-lg font-semibold text-gray-700 mb-3">Payment Information (DEMO)</h2>
                    <div class="space-y-4">
                        <div class="card-input-wrapper">
                            <input type="text" id="card-number" class="form-input" placeholder="Card Number" required pattern="\d{4} \d{4} \d{4} \d{4}" title="Enter a 16-digit card number format.">
                            <svg class="card-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-credit-card"><rect width="20" height="14" x="2" y="5" rx="2"/><line x1="2" x2="22" y1="10" y2="10"/></svg>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <input type="text" id="expiry-date" class="form-input" placeholder="MM / YY" required pattern="(0[1-9]|1[0-2])\s?\/\s?\d{2}" title="Enter expiry in MM / YY format.">
                            <input type="text" id="cvv" class="form-input" placeholder="CVC" required pattern="\d{3,4}" title="Enter a 3 or 4 digit CVC.">
                        </div>
                    </div>
                    <p class="text-xs text-gray-500 mt-3 text-center">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block mr-1 h-4 w-4"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg>
                        This is a demo form. Do NOT enter real credit card information.
                    </p>
                </div>

                <div class="mt-8">
                    <button type="submit" class="btn btn-primary text-lg">
                        Donate Now
                    </button>
                </div>
            </form>
             <div class="mt-6 text-center">
                <a href="#" id="admin-link" class="text-sm text-gray-500 hover:text-blue-600 hover:underline">Site Admin View</a>
            </div>
        </div>

        <!-- Thank You Message -->
        <div id="thank-you-message" class="w-full max-w-lg mx-auto bg-white rounded-2xl shadow-xl p-8 text-center transition-all duration-500 hidden">
            <svg class="mx-auto h-16 w-16 text-green-500" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
            <h1 class="text-3xl font-bold text-gray-800 mt-4">Thank You!</h1>
            <p class="text-gray-600 mt-2">Your generous donation has been simulated successfully.</p>
            <div class="text-left bg-gray-50 rounded-lg p-4 mt-6 border border-gray-200">
                <h3 class="font-semibold text-gray-700 mb-2">Donation Summary (DEMO)</h3>
                <p class="text-gray-600"><strong>Donor:</strong> <span id="summary-name"></span></p>
                <p class="text-gray-600"><strong>Email:</strong> <span id="summary-email"></span></p>
                <p class="text-gray-600"><strong>Amount:</strong> <span id="summary-amount"></span></p>
                <p class="text-gray-600"><strong>Card Number (Masked):</strong> <span id="summary-card"></span></p>
            </div>
            <button onclick="showDonationView()" class="mt-6 w-full max-w-xs mx-auto btn bg-gray-600 hover:bg-gray-700">Make Another Donation</button>
        </div>

        <!-- Admin View -->
        <div id="admin-view" class="w-full max-w-4xl mx-auto bg-white rounded-2xl shadow-xl p-8 transition-all duration-500 hidden">
            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4">
                <h1 class="text-2xl md:text-3xl font-bold text-gray-800">Admin Panel - Donations</h1>
                <div class="flex">
                    <button id="clear-donations-btn" class="text-sm text-white bg-red-600 hover:bg-red-700 rounded-lg px-4 py-2 mr-2 transition-colors">Clear All</button>
                    <button id="back-to-form-btn" class="text-sm text-white bg-blue-600 hover:bg-blue-700 rounded-lg px-4 py-2 transition-colors">Back to Form</button>
                </div>
            </div>
            <div class="overflow-x-auto rounded-lg border border-gray-200">
                <table class="min-w-full bg-white">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="py-3 px-4 border-b text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Donor Name</th>
                            <th class="py-3 px-4 border-b text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Email</th>
                            <th class="py-3 px-4 border-b text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Amount</th>
                            <th class="py-3 px-4 border-b text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Card (Masked)</th>
                            <th class="py-3 px-4 border-b text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Date</th>
                        </tr>
                    </thead>
                    <tbody id="donations-table-body" class="divide-y divide-gray-200">
                        <!-- Donation rows will be inserted here by JavaScript -->
                    </tbody>
                </table>
                <p id="no-donations-message" class="text-center text-gray-500 py-8 hidden">No donations have been made yet.</p>
            </div>
        </div>
    </div>
    
    <!-- Custom Modal -->
    <div id="custom-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-50">
        <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-sm text-center">
            <p id="modal-text" class="text-gray-800 text-lg mb-6"></p>
            <div id="modal-buttons" class="flex justify-center space-x-4">
                <!-- Buttons are added dynamically by JavaScript -->
            </div>
        </div>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const amountButtons = document.querySelectorAll('.donation-amount-btn');
            const customAmountInput = document.getElementById('custom-amount');

            amountButtons.forEach(button => {
                button.addEventListener('click', () => {
                    amountButtons.forEach(btn => btn.classList.remove('selected'));
                    button.classList.add('selected');
                    customAmountInput.value = '';
                });
            });
            
            customAmountInput.addEventListener('input', () => {
                amountButtons.forEach(btn => btn.classList.remove('selected'));
            });

            const cardNumberInput = document.getElementById('card-number');
            cardNumberInput.addEventListener('input', (e) => {
                let value = e.target.value.replace(/\D/g, '').substring(0, 16);
                value = value.replace(/(\d{4})/g, '$1 ').trim();
                e.target.value = value;
            });

            const expiryDateInput = document.getElementById('expiry-date');
            expiryDateInput.addEventListener('input', (e) => {
                let value = e.target.value.replace(/\D/g, '').substring(0, 4);
                if (value.length > 2) {
                    value = value.substring(0, 2) + ' / ' + value.substring(2);
                }
                e.target.value = value;
            });

            // Admin functionality event listeners
            document.getElementById('admin-link').addEventListener('click', (e) => {
                e.preventDefault();
                showAdminView();
            });

            document.getElementById('back-to-form-btn').addEventListener('click', showDonationView);

            document.getElementById('clear-donations-btn').addEventListener('click', () => {
                showModal(
                    'Are you sure you want to delete all donation records? This cannot be undone.', 
                    'confirm', 
                    () => {
                        localStorage.removeItem('donations');
                        populateDonationsTable();
                    }
                );
            });
        });

        function showModal(message, type = 'alert', onConfirm = null) {
            const modal = document.getElementById('custom-modal');
            const modalText = document.getElementById('modal-text');
            const modalButtons = document.getElementById('modal-buttons');

            modalText.textContent = message;
            modalButtons.innerHTML = '';

            if (type === 'confirm') {
                const cancelButton = document.createElement('button');
                cancelButton.textContent = 'Cancel';
                cancelButton.className = 'px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 w-24';
                cancelButton.onclick = () => modal.classList.add('hidden');
                modalButtons.appendChild(cancelButton);

                const confirmButton = document.createElement('button');
                confirmButton.textContent = 'OK';
                confirmButton.className = 'px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 w-24';
                confirmButton.onclick = () => {
                    modal.classList.add('hidden');
                    if (onConfirm) onConfirm();
                };
                modalButtons.appendChild(confirmButton);
            } else { // 'alert' type
                const okButton = document.createElement('button');
                okButton.textContent = 'OK';
                okButton.className = 'px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 w-24';
                okButton.onclick = () => modal.classList.add('hidden');
                modalButtons.appendChild(okButton);
            }
            modal.classList.remove('hidden');
        }

        function handleDonation(event) {
            event.preventDefault();
            
            const name = document.getElementById('donor-name').value;
            const email = document.getElementById('donor-email').value;
            const cardNumber = document.getElementById('card-number').value;
            
            let amount = 0;
            const selectedAmountBtn = document.querySelector('.donation-amount-btn.selected');
            const customAmount = document.getElementById('custom-amount').value;

            if (customAmount) {
                amount = parseFloat(customAmount);
            } else if (selectedAmountBtn) {
                amount = parseFloat(selectedAmountBtn.dataset.amount);
            }

            if (amount <= 0) {
                showModal('Please select or enter a valid donation amount.');
                return;
            }

            // --- SAVE TO LOCAL STORAGE (SIMULATED DATABASE) ---
            const donationData = {
                name, email,
                amount: amount.toFixed(2),
                cardNumber,
                date: new Date().toLocaleString()
            };

            const donations = JSON.parse(localStorage.getItem('donations')) || [];
            donations.unshift(donationData); // Add new donations to the top
            localStorage.setItem('donations', JSON.stringify(donations));

            // Display summary on thank you page
            document.getElementById('summary-name').textContent = name;
            document.getElementById('summary-email').textContent = email;
            document.getElementById('summary-amount').textContent = `$${amount.toFixed(2)}`;
            document.getElementById('summary-card').textContent = `**** **** **** ${cardNumber.slice(-4)}`;

            // Switch views
            document.getElementById('donation-form-container').classList.add('hidden');
            document.getElementById('thank-you-message').classList.remove('hidden');
        }
        
        function showAdminView() {
            document.getElementById('donation-form-container').classList.add('hidden');
            document.getElementById('thank-you-message').classList.add('hidden');
            document.getElementById('admin-view').classList.remove('hidden');
            populateDonationsTable();
        }

        function showDonationView() {
            document.getElementById('admin-view').classList.add('hidden');
            document.getElementById('thank-you-message').classList.add('hidden');
            document.getElementById('donation-form-container').classList.remove('hidden');
            resetForm();
        }
        
        function resetForm() {
            document.getElementById('donation-form').reset();
            document.querySelectorAll('.donation-amount-btn').forEach(btn => btn.classList.remove('selected'));
            document.querySelector('.donation-amount-btn[data-amount="50"]').classList.add('selected');
        }

        function populateDonationsTable() {
            const donations = JSON.parse(localStorage.getItem('donations')) || [];
            const tableBody = document.getElementById('donations-table-body');
            const noDonationsMessage = document.getElementById('no-donations-message');

            tableBody.innerHTML = ''; 

            if (donations.length === 0) {
                noDonationsMessage.classList.remove('hidden');
                noDonationsMessage.parentElement.querySelector('table').classList.add('hidden');

            } else {
                noDonationsMessage.classList.add('hidden');
                noDonationsMessage.parentElement.querySelector('table').classList.remove('hidden');
                donations.forEach(d => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-50';
                    row.innerHTML = `
                        <td class="py-3 px-4">${d.name}</td>
                        <td class="py-3 px-4">${d.email}</td>
                        <td class="py-3 px-4">$${d.amount}</td>
                        <td class="py-3 px-4 font-mono">**** **** **** ${d.cardNumber.slice(-4)}</td>
                        <td class="py-3 px-4 text-sm text-gray-600">${d.date}</td>
                    `;
                    tableBody.appendChild(row);
                });
            }
        }
    </script>
</body>
</html>

